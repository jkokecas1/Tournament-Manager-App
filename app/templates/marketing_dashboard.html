{% extends "sidebar_layout.html" %}

{% block layout_content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <h2 style="margin: 0;">üèÜ {{ _('Panel de Premios') }}</h2>
    <div style="display: flex; gap: 10px;">
        <button class="btn" onclick="document.getElementById('addPrizeModal').style.display='block'">
            üèÜ {{ _('A√±adir Premio') }}
        </button>
    </div>
</div>

<!-- Prize Management -->
<div class="card" style="margin-bottom: 30px; border-left: 5px solid var(--augment);">
    <h3>üèÜ {{ _('Gesti√≥n de Premios por Torneo') }}</h3>
    <table style="width: 100%;">
        <thead>
            <tr>
                <th>{{ _('Torneo') }}</th>
                <th>{{ _('Rango') }}</th>
                <th>{{ _('T√≠tulo') }}</th>
                <th>{{ _('Premio') }}</th>
                <th style="text-align: right;">{{ _('Acciones') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for prize in prizes %}
            <tr>
                <td>{{ prize.tournament.name }}</td>
                <td><span class="badge">{{ prize.rank }}</span></td>
                <td><strong>{{ prize.title }}</strong></td>
                <td>{{ prize.reward_value }}</td>
                <td style="text-align: right;">
                    <form action="{{ url_for('marketing.delete_prize', p_id=prize.id) }}" method="post"
                        style="display: inline;">
                        <button type="submit" class="btn btn-danger btn-sm"
                            onclick="return confirm('¬øEliminar premio?')">üóëÔ∏è</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" style="text-align: center; color: #999; padding: 20px;">
                    {{ _('No hay premios configurados a√∫n.') }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Modals -->
<div id="addPrizeModal"
    style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5);">
    <div class="card" style="width: 500px; margin: 100px auto; position: relative;">
        <h3>üèÜ {{ _('Configurar Nuevo Premio') }}</h3>
        <form action="{{ url_for('marketing.add_prize') }}" method="post">
            <div style="margin-bottom: 15px;">
                <label>{{ _('Torneo') }}</label>
                <select name="tournament_id" style="width: 100%;" required>
                    {% for t in tournaments %}
                    <option value="{{ t.id }}">{{ t.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <div>
                    <label>{{ _('Rango / Categor√≠a') }}</label>
                    <input type="text" name="rank" placeholder="e.g., 1er Lugar" required style="width: 100%;">
                </div>
                <div>
                    <label>{{ _('Nombre del Premio') }}</label>
                    <input type="text" name="title" placeholder="e.g., Trofeo de Oro" required style="width: 100%;">
                </div>
            </div>
            <div style="margin-bottom: 15px;">
                <label>{{ _('Valor / Recompensa') }}</label>
                <input type="text" name="reward_value" placeholder="e.g., $1000 + Medalla" style="width: 100%;">
            </div>
            <div style="margin-bottom: 20px;">
                <label>{{ _('Descripci√≥n') }}</label>
                <textarea name="description" rows="3" style="width: 100%;"></textarea>
            </div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button type="button" class="btn btn-secondary"
                    onclick="document.getElementById('addPrizeModal').style.display='none'">{{ _('Cancelar') }}</button>
                <button type="submit" class="btn">{{ _('Guardar Premio') }}</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}